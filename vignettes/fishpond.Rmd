---
title: "Fishpond: DGE and DTE with inferential replicates"
date: "`r format(Sys.Date(), '%m/%d/%Y')`"
author: "Anqi Zhu, Rob Patro, Michael Love"
output:
  rmarkdown::html_document:
    highlight: tango
vignette: |
  %\VignetteIndexEntry{Fishpond}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<!-- run this document with library(rmarkdown); render("fishpond.Rmd") -->

```{r setup, echo=FALSE, results="hide"}
knitr::opts_chunk$set(tidy=FALSE, cache=TRUE,
                      dev="png",
                      message=FALSE, error=FALSE, warning=FALSE)
```

```{r}
suppressPackageStartupMessages(library(SummarizedExperiment))
```

```{r}
library(fishpond)
y <- makeSimSwishData()
y <- scaleInfReps(y)
y <- labelKeep(y)
y <- swish(y, x="condition")
```

```{r}
plotInfReps(y, 3, "condition")
```

```{r}
y <- makeSimSwishData(n=20)
y$batch <- factor(rep(c(1,2,1,2),each=5))
y <- scaleInfReps(y)
y <- labelKeep(y)
y <- swish(y, x="condition", cov="batch")
```

```{r}
plotInfReps(y, 3, "condition", "batch")
```
